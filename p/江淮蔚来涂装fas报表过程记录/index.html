<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ä¿®æ”¹éœ€æ±‚ï¼š è®¾å¤‡æŠ¥è­¦TOP ç¬¬äºŒåˆ—åŠ ä¸ŠDvcCd,æœç´¢æ¡ä»¶å»æ‰æ•…éšœè¯´æ˜ï¼Œè¡¨æ ¼ä¸Šæ–¹åŠ å…¥æŸ±çŠ¶å›¾ï¼ˆæŒ‰DvcCdåˆ†ç»„è®¡ç®—ï¼‰
è½¦èº«å·¥è‰ºå‚æ•° é‡‡é›†åç§°åšä¸‹æ‹‰æ¡†
ANDON 1.Andonæ‹‰ç»³æ—¶é•¿top10 --å‚è€ƒå®‰é©°æŠ¥è¡¨-å½“å¤©ANDONåœçº¿æ—¶é•¿TOP10 select distinct PlineNm--â€äº§çº¿åç§°â€œ , sum(cast(SUBSTRING(SLContTm,1,2) as int) )*60&#43;sum( cast(SUBSTRING(SLContTm,4,2) as int))&#43;sum(cast(SUBSTRING(SLContTm,7,2) as int))/60asåˆ†--å°†åœçº¿æŒç»­æ—¶é—´è½¬æ¢ä¸ºä»¥â€œåˆ†â€œä¸ºå•ä½ from BPIE_SLDoc --åœçº¿æ—¥å¿—è¡¨ where sLContTm is not null --â€æŒç»­æ—¶é—´â€œéç©ºand Enabled=1 and datediff(day,sLStrtTm, &amp;#39;$igetdate} &amp;#39;)=o --å°†â€åœçº¿å¼€å§‹æ—¶é—´â€œè½¬æ¢ä¸ºå‚æ•°é¢æ¿ä¸­çš„æŸ¥è¯¢æ—¶é—´çš„æ ¼å¼å¹¶ä¸ä¹‹å¯¹åº”group by PlineNm --ä»¥â€äº§çº¿åç§°â€œåˆ†ç»„ order byåˆ†DESC --ä»¥å¤„é¿â€æŒç»­æ—¶é—´â€œä¸ºâ€åˆ†è¿›è¡Œæ’åº æŸ¥A_AndonManagement_Pro a LEFT JOIN A_AndonInfo_Record b ON a.AndonId =b.AndonId ï¼ŒæŒ‰ç…§è¾“å…¥çš„æ—¶é—´èŒƒå›´ä»¥PlinCdåˆ†ç»„æŸ¥è¯¢ï¼Œä»¥ç´¯åŠ çš„æ—¶é•¿[AndonDurationTime]æ’åº
Andonçš„æŠ¥è¡¨å¯ä»¥ç”¨äº§çº¿ç¼–å·æŸ¥BBdbR_PlineBaseæŠŠEnabled=1äº§çº¿åç§°æŸ¥å‡ºæ¥ä½œä¸ºæ¨ªåæ ‡
æ•°æ®ç»“æ„åˆ†æ
åœ¨åœçº¿ä¿¡æ¯ç®¡ç†è¿‡ç¨‹è¡¨ä¸­ï¼Œâ€œæŒç»­æ—¶é—´â€&amp;ndash;AndonDurationTime çš„å•ä½ä¸ºç§’ åœ¨æŸ¥è¯¢ç»“æœçš„å¤„ç†ä¸­éœ€è¦å¤„ç†ä¸ºåˆ†é’Ÿ
--SQLè¯­å¥ æ— TOP 10 æŸ¥è¯¢ç‰ˆæœ¬ --äº§çº¿åç§°ä¸ºæ¨ªåæ ‡ SELECT DISTINCT PlineNm,SUM(AndonDurationTime)/60 AS åˆ† FROM A_AndonManagement_Pro a LEFT JOIN BBdbR_PlineBase b ON a.'><title>æ±Ÿæ·®è”šæ¥æ¶‚è£…FASæŠ¥è¡¨è¿‡ç¨‹è®°å½•</title>

<link rel='canonical' href='https://jianrongma.github.io/p/%E6%B1%9F%E6%B7%AE%E8%94%9A%E6%9D%A5%E6%B6%82%E8%A3%85fas%E6%8A%A5%E8%A1%A8%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/'>

<link rel="stylesheet" href="/scss/style.min.css">
<style>
     
    body{
        background-repeat: repeat;
        background-attachment: fixed;
        background-size:cover;
         cursor: url(https://files.cnblogs.com/files/monster-jian/cursor.ico),auto;
    }
     
    #div_digg {
      position: fixed;
      bottom: 10px;
      right: 15px;
      border: 2px solid #ECD7B1;
      padding: 10px;
      width: 140px;
      background-color: #fff;
      border-radius: 5px 5px 5px 5px !important;
      box-shadow: 0 0 0 1px #5F5A4B, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);
    }
    </style><script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

<script src="https://files.cnblogs.com/files/liyhbk/js.js" color="0,0,255" opacity="1" count="119" zindex="-2"></script>
<script src="https://files.cnblogs.com/files/liyhbk/js.js" color="0,0,255" opacity="1" count="119" zindex="-2">
</script>
<script type="text/javascript" color="255,0,0" pointcolor="255,0,0" opacity="0.7" zindex="-2" count="100" src="/dist/canvas-nest.js"></script>
<script type="text/javascript" src="/dist/canvas-nest.umd.js"></script>
<script type="text/javascript">
    var cn = new CanvasNest(document.getElementById('area-render'), {
        color: '255,0,255',
        count: 50,
      });
      
      function asyncLoad() {
        
        var i = document.createElement("iframe");
        i.src = "https://ghbtns.com/github-btn.html?user=hustcc&repo=canvas-nest.js&type=star&count=true";
        i.scrolling = "no";
        i.frameborder = "0";
        i.border = "0";
        i.setAttribute("frameborder", "0", 0);
        i.width = "100px";
        i.height = "20px";
        document.getElementById("github-iframe").appendChild(i);
      }
      function loadGitHubBtn() {
        if (window.addEventListener) {window.addEventListener("load", asyncLoad, false);}
        else if (window.attachEvent) {window.attachEvent("onload", asyncLoad);}
        else {window.onload = asyncLoad;}
      }
      loadGitHubBtn();
</script>
<script src="/canvas-nest.js?version=10"></script><canvas width="1536" height="454" style="display: block; position: absolute; top: 0px; left: 0px; height: 100%; width: 100%; overflow: hidden; pointer-events: none;"></canvas>
<script src="https://files.cnblogs.com/files/monster-jian/mouse-click.js"></script>
<script type="text/javascript">
    
     
    var a_idx = 0;
    jQuery(document).ready(function($) {
        $("body").click(function(e) {
            var a = new Array("â¤ä¸åšå’¸é±¼ï¼â¤","â¤æ‹’ç»æ‡’æƒ°ï¼â¤","â¤æƒ³åšåƒè´§â¤","â¤å‘å¤§ä½¬å­¦ä¹ â¤","â¤æ‰¶æˆ‘èµ·æ¥~â¤","â¤come onâ¤","â¤ä¸€ç›´åœ¨è·¯ä¸Š~â¤","â¤ç´¯äº†~â¤","â¤å†è¶´ä¸€ä¼šâ¤","â¤66666â¤","â¤é«˜å…´çš„é£èµ·*****â¤");
            var $i = $("<span></span>").text(a[a_idx]);
            a_idx = (a_idx + 1) % a.length;
            var x = e.pageX,
            y = e.pageY;
            $i.css({
                "z-index": 999999999999999999999999999999999999999999999999999999999999999999999,
                "top": y - 20,
                "left": x,
                "position": "absolute",
                "font-weight": "bold",
                "color": "rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"
            });
            $("body").append($i);
            $i.animate({
                "top": y - 180,
                "opacity": 0
            },
            1500,
            function() {
                $i.remove();
            });
        });
    });
    </script>

    <script src="https://eqcn.ajz.miesnfu.com/wp-content/plugins/wp-3d-pony/live2dw/lib/L2Dwidget.min.js"></script>  

 
   
      
      
          
         <script>         
            L2Dwidget.init({ "model": { jsonPath:          "https://unpkg.com/live2d-widget-model-shizuku@1.0.5/assets/shizuku.model.json",  
                  "scale": 1 }, "display": { "position": "right", "width": 66, "height": 88,        "hOffset": 0, "vOffset": -20 },
                   "mobile": { "show": true, "scale": 0.5 },      "react": { "opacityDefault": 0.8, "opacityOnHover": 0.1 } }); 
                    </script><meta property='og:title' content='æ±Ÿæ·®è”šæ¥æ¶‚è£…FASæŠ¥è¡¨è¿‡ç¨‹è®°å½•'>
<meta property='og:description' content='ä¿®æ”¹éœ€æ±‚ï¼š è®¾å¤‡æŠ¥è­¦TOP ç¬¬äºŒåˆ—åŠ ä¸ŠDvcCd,æœç´¢æ¡ä»¶å»æ‰æ•…éšœè¯´æ˜ï¼Œè¡¨æ ¼ä¸Šæ–¹åŠ å…¥æŸ±çŠ¶å›¾ï¼ˆæŒ‰DvcCdåˆ†ç»„è®¡ç®—ï¼‰
è½¦èº«å·¥è‰ºå‚æ•° é‡‡é›†åç§°åšä¸‹æ‹‰æ¡†
ANDON 1.Andonæ‹‰ç»³æ—¶é•¿top10 --å‚è€ƒå®‰é©°æŠ¥è¡¨-å½“å¤©ANDONåœçº¿æ—¶é•¿TOP10 select distinct PlineNm--â€äº§çº¿åç§°â€œ , sum(cast(SUBSTRING(SLContTm,1,2) as int) )*60&#43;sum( cast(SUBSTRING(SLContTm,4,2) as int))&#43;sum(cast(SUBSTRING(SLContTm,7,2) as int))/60asåˆ†--å°†åœçº¿æŒç»­æ—¶é—´è½¬æ¢ä¸ºä»¥â€œåˆ†â€œä¸ºå•ä½ from BPIE_SLDoc --åœçº¿æ—¥å¿—è¡¨ where sLContTm is not null --â€æŒç»­æ—¶é—´â€œéç©ºand Enabled=1 and datediff(day,sLStrtTm, &amp;#39;$igetdate} &amp;#39;)=o --å°†â€åœçº¿å¼€å§‹æ—¶é—´â€œè½¬æ¢ä¸ºå‚æ•°é¢æ¿ä¸­çš„æŸ¥è¯¢æ—¶é—´çš„æ ¼å¼å¹¶ä¸ä¹‹å¯¹åº”group by PlineNm --ä»¥â€äº§çº¿åç§°â€œåˆ†ç»„ order byåˆ†DESC --ä»¥å¤„é¿â€æŒç»­æ—¶é—´â€œä¸ºâ€åˆ†è¿›è¡Œæ’åº æŸ¥A_AndonManagement_Pro a LEFT JOIN A_AndonInfo_Record b ON a.AndonId =b.AndonId ï¼ŒæŒ‰ç…§è¾“å…¥çš„æ—¶é—´èŒƒå›´ä»¥PlinCdåˆ†ç»„æŸ¥è¯¢ï¼Œä»¥ç´¯åŠ çš„æ—¶é•¿[AndonDurationTime]æ’åº
Andonçš„æŠ¥è¡¨å¯ä»¥ç”¨äº§çº¿ç¼–å·æŸ¥BBdbR_PlineBaseæŠŠEnabled=1äº§çº¿åç§°æŸ¥å‡ºæ¥ä½œä¸ºæ¨ªåæ ‡
æ•°æ®ç»“æ„åˆ†æ
åœ¨åœçº¿ä¿¡æ¯ç®¡ç†è¿‡ç¨‹è¡¨ä¸­ï¼Œâ€œæŒç»­æ—¶é—´â€&amp;ndash;AndonDurationTime çš„å•ä½ä¸ºç§’ åœ¨æŸ¥è¯¢ç»“æœçš„å¤„ç†ä¸­éœ€è¦å¤„ç†ä¸ºåˆ†é’Ÿ
--SQLè¯­å¥ æ— TOP 10 æŸ¥è¯¢ç‰ˆæœ¬ --äº§çº¿åç§°ä¸ºæ¨ªåæ ‡ SELECT DISTINCT PlineNm,SUM(AndonDurationTime)/60 AS åˆ† FROM A_AndonManagement_Pro a LEFT JOIN BBdbR_PlineBase b ON a.'>
<meta property='og:url' content='https://jianrongma.github.io/p/%E6%B1%9F%E6%B7%AE%E8%94%9A%E6%9D%A5%E6%B6%82%E8%A3%85fas%E6%8A%A5%E8%A1%A8%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/'>
<meta property='og:site_name' content='think hy how to learn'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2022-04-10T10:31:06&#43;08:00'/><meta property='article:modified_time' content='2022-04-10T10:31:06&#43;08:00'/><meta property='og:image' content='https://jianrongma.github.io/img/avatar.png' />
<meta name="twitter:site" content="@ljsljs56495989">
    <meta name="twitter:creator" content="@ljsljs56495989"><meta name="twitter:title" content="æ±Ÿæ·®è”šæ¥æ¶‚è£…FASæŠ¥è¡¨è¿‡ç¨‹è®°å½•">
<meta name="twitter:description" content="ä¿®æ”¹éœ€æ±‚ï¼š è®¾å¤‡æŠ¥è­¦TOP ç¬¬äºŒåˆ—åŠ ä¸ŠDvcCd,æœç´¢æ¡ä»¶å»æ‰æ•…éšœè¯´æ˜ï¼Œè¡¨æ ¼ä¸Šæ–¹åŠ å…¥æŸ±çŠ¶å›¾ï¼ˆæŒ‰DvcCdåˆ†ç»„è®¡ç®—ï¼‰
è½¦èº«å·¥è‰ºå‚æ•° é‡‡é›†åç§°åšä¸‹æ‹‰æ¡†
ANDON 1.Andonæ‹‰ç»³æ—¶é•¿top10 --å‚è€ƒå®‰é©°æŠ¥è¡¨-å½“å¤©ANDONåœçº¿æ—¶é•¿TOP10 select distinct PlineNm--â€äº§çº¿åç§°â€œ , sum(cast(SUBSTRING(SLContTm,1,2) as int) )*60&#43;sum( cast(SUBSTRING(SLContTm,4,2) as int))&#43;sum(cast(SUBSTRING(SLContTm,7,2) as int))/60asåˆ†--å°†åœçº¿æŒç»­æ—¶é—´è½¬æ¢ä¸ºä»¥â€œåˆ†â€œä¸ºå•ä½ from BPIE_SLDoc --åœçº¿æ—¥å¿—è¡¨ where sLContTm is not null --â€æŒç»­æ—¶é—´â€œéç©ºand Enabled=1 and datediff(day,sLStrtTm, &amp;#39;$igetdate} &amp;#39;)=o --å°†â€åœçº¿å¼€å§‹æ—¶é—´â€œè½¬æ¢ä¸ºå‚æ•°é¢æ¿ä¸­çš„æŸ¥è¯¢æ—¶é—´çš„æ ¼å¼å¹¶ä¸ä¹‹å¯¹åº”group by PlineNm --ä»¥â€äº§çº¿åç§°â€œåˆ†ç»„ order byåˆ†DESC --ä»¥å¤„é¿â€æŒç»­æ—¶é—´â€œä¸ºâ€åˆ†è¿›è¡Œæ’åº æŸ¥A_AndonManagement_Pro a LEFT JOIN A_AndonInfo_Record b ON a.AndonId =b.AndonId ï¼ŒæŒ‰ç…§è¾“å…¥çš„æ—¶é—´èŒƒå›´ä»¥PlinCdåˆ†ç»„æŸ¥è¯¢ï¼Œä»¥ç´¯åŠ çš„æ—¶é•¿[AndonDurationTime]æ’åº
Andonçš„æŠ¥è¡¨å¯ä»¥ç”¨äº§çº¿ç¼–å·æŸ¥BBdbR_PlineBaseæŠŠEnabled=1äº§çº¿åç§°æŸ¥å‡ºæ¥ä½œä¸ºæ¨ªåæ ‡
æ•°æ®ç»“æ„åˆ†æ
åœ¨åœçº¿ä¿¡æ¯ç®¡ç†è¿‡ç¨‹è¡¨ä¸­ï¼Œâ€œæŒç»­æ—¶é—´â€&amp;ndash;AndonDurationTime çš„å•ä½ä¸ºç§’ åœ¨æŸ¥è¯¢ç»“æœçš„å¤„ç†ä¸­éœ€è¦å¤„ç†ä¸ºåˆ†é’Ÿ
--SQLè¯­å¥ æ— TOP 10 æŸ¥è¯¢ç‰ˆæœ¬ --äº§çº¿åç§°ä¸ºæ¨ªåæ ‡ SELECT DISTINCT PlineNm,SUM(AndonDurationTime)/60 AS åˆ† FROM A_AndonManagement_Pro a LEFT JOIN BBdbR_PlineBase b ON a."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://jianrongma.github.io/img/avatar.png' />
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
   
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <style>
            * {
              margin: 0;
              padding: 0;
            }
            html, body {
              height: 100%;
              width: 100%;
            }
            #github-iframe {
              position: fixed;
              left: 32px;
              top: 32px;
            }
             
        </style>
   


<link rel="stylesheet" type="texts" href="https://blog-static.cnblogs.com/files/monster-jian/waifu.css"/>


</head>







<script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1280473365'%3E%3C/span%3E%3Cscript src='https://s9.cnzz.com/z_stat.php%3Fid%3D1280473365%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>

<body size-sensor-id="1" style="position: relative;">
    
    <div id="area-render"></div>
   

</body>

<canvas width="1777" height="841" style="position: fixed; left: 0px; top: 0px; z-index: 2147483647; pointer-events: none;"></canvas>

</html>


    </head>
    <body class="
    article-page 
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        on-phone--column extended
    
">
    
        <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/hanbagui_hu1992e2ef3ca17530e3489d97af7cbea6_3164_300x0_resize_box.bmp" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        <h1 class="site-name"><a href="https://jianrongma.github.io/">think hy how to learn</a></h1>
        <h2 class="site-description">å¥½è¿æš´å¯Œ,å°±åœ¨ä»Šæ—¥.</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>æš—è‰²æ¨¡å¼</span>
            </li>
        
    </ol>
</aside>

    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/-%E9%A1%B9%E7%9B%AE%E7%9B%B8%E5%85%B3/" >
                -é¡¹ç›®ç›¸å…³
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/%E6%B1%9F%E6%B7%AE%E8%94%9A%E6%9D%A5%E6%B6%82%E8%A3%85fas%E6%8A%A5%E8%A1%A8%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/">æ±Ÿæ·®è”šæ¥æ¶‚è£…FASæŠ¥è¡¨è¿‡ç¨‹è®°å½•</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Apr 10, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 16 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h3 id="ä¿®æ”¹éœ€æ±‚">ä¿®æ”¹éœ€æ±‚ï¼š</h3>
<h4 id="è®¾å¤‡æŠ¥è­¦top">è®¾å¤‡æŠ¥è­¦TOP</h4>
<p>ç¬¬äºŒåˆ—åŠ ä¸ŠDvcCd,æœç´¢æ¡ä»¶å»æ‰æ•…éšœè¯´æ˜ï¼Œè¡¨æ ¼ä¸Šæ–¹åŠ å…¥æŸ±çŠ¶å›¾ï¼ˆæŒ‰DvcCdåˆ†ç»„è®¡ç®—ï¼‰</p>
<h4 id="è½¦èº«å·¥è‰ºå‚æ•°">è½¦èº«å·¥è‰ºå‚æ•°</h4>
<p>é‡‡é›†åç§°åšä¸‹æ‹‰æ¡†</p>
<h2 id="andon">ANDON</h2>
<h3 id="1andonæ‹‰ç»³æ—¶é•¿top10">1.Andonæ‹‰ç»³æ—¶é•¿top10</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--å‚è€ƒå®‰é©°æŠ¥è¡¨-å½“å¤©ANDONåœçº¿æ—¶é•¿TOP10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">PlineNm</span><span class="c1">--â€äº§çº¿åç§°â€œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="n">SLContTm</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="mi">60</span><span class="o">+</span><span class="k">sum</span><span class="p">(</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="n">SLContTm</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">int</span><span class="p">))</span><span class="o">+</span><span class="k">sum</span><span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="n">SLContTm</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">int</span><span class="p">))</span><span class="o">/</span><span class="mi">60</span><span class="n">as</span><span class="err">åˆ†</span><span class="c1">--å°†åœçº¿æŒç»­æ—¶é—´è½¬æ¢ä¸ºä»¥â€œåˆ†â€œä¸ºå•ä½
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">BPIE_SLDoc</span><span class="w"> </span><span class="c1">--åœçº¿æ—¥å¿—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="n">sLContTm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="c1">--â€æŒç»­æ—¶é—´â€œéç©ºand Enabled=1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">and</span><span class="w"> </span><span class="n">datediff</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="n">sLStrtTm</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;$igetdate} &#39;</span><span class="p">)</span><span class="o">=</span><span class="n">o</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å°†â€åœçº¿å¼€å§‹æ—¶é—´â€œè½¬æ¢ä¸ºå‚æ•°é¢æ¿ä¸­çš„æŸ¥è¯¢æ—¶é—´çš„æ ¼å¼å¹¶ä¸ä¹‹å¯¹åº”group by PlineNm --ä»¥â€äº§çº¿åç§°â€œåˆ†ç»„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">order</span><span class="w"> </span><span class="n">by</span><span class="err">åˆ†</span><span class="k">DESC</span><span class="w"> </span><span class="c1">--ä»¥å¤„é¿â€æŒç»­æ—¶é—´â€œä¸ºâ€åˆ†è¿›è¡Œæ’åº
</span></span></span></code></pre></div><ul>
<li>
<p>æŸ¥A_AndonManagement_Pro a LEFT JOIN A_AndonInfo_Record b ON a.AndonId =b.AndonId ï¼ŒæŒ‰ç…§è¾“å…¥çš„æ—¶é—´èŒƒå›´ä»¥PlinCdåˆ†ç»„æŸ¥è¯¢ï¼Œä»¥ç´¯åŠ çš„æ—¶é•¿[AndonDurationTime]æ’åº</p>
</li>
<li>
<p>Andonçš„æŠ¥è¡¨å¯ä»¥ç”¨äº§çº¿ç¼–å·æŸ¥<strong>BBdbR_PlineBase</strong>æŠŠEnabled=1äº§çº¿åç§°æŸ¥å‡ºæ¥ä½œä¸ºæ¨ªåæ ‡</p>
</li>
<li>
<p>æ•°æ®ç»“æ„åˆ†æ</p>
<p>åœ¨åœçº¿ä¿¡æ¯ç®¡ç†è¿‡ç¨‹è¡¨ä¸­ï¼Œâ€œæŒç»­æ—¶é—´â€&ndash;AndonDurationTime çš„å•ä½ä¸ºç§’ åœ¨æŸ¥è¯¢ç»“æœçš„å¤„ç†ä¸­éœ€è¦å¤„ç†ä¸ºåˆ†é’Ÿ</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--SQLè¯­å¥ æ— TOP 10 æŸ¥è¯¢ç‰ˆæœ¬
</span></span></span><span class="line"><span class="cl"><span class="c1">--äº§çº¿åç§°ä¸ºæ¨ªåæ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">PlineNm</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">AndonDurationTime</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">åˆ†</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">A_AndonManagement_Pro</span><span class="w"> </span><span class="n">a</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="n">b</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PlineCd</span><span class="w"> </span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">PlineCd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">AndonDurationTime</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AndonStartTime</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2022-09-20&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">PlineNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">åˆ†</span><span class="w"> </span><span class="k">DESC</span><span class="w">  </span><span class="c1">---DESC é™åºæ’åˆ—
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--SQLè¯­å¥ TOP 10 æŸ¥è¯¢ç‰ˆæœ¬
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">TOP</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">PlineNm</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">AndonDurationTime</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">åˆ†</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">A_AndonManagement_Pro</span><span class="w"> </span><span class="n">a</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="n">b</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PlineCd</span><span class="w"> </span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">PlineCd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Type</span><span class="o">=</span><span class="s1">&#39;äº§çº¿&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">isFile</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">AndonDurationTime</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AndonStartTime</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;${getdate}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">PlineNm</span><span class="p">)</span><span class="w"> </span><span class="n">T</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">åˆ†</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></div><h3 id="2andonæ‹‰ç»³æ¬¡æ•°top10">2.Andonæ‹‰ç»³æ¬¡æ•°TOP10</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--æ‹‰åœæ¬¡æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">TOP</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">PlineNm</span><span class="p">,</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">æ¬¡æ•°</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">A_AndonManagement_Pro</span><span class="w"> </span><span class="n">a</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="n">b</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PlineCd</span><span class="w"> </span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">PlineCd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Type</span><span class="o">=</span><span class="s1">&#39;äº§çº¿&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">isFile</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AndonStartTime</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2022-09-21&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">PlineNm</span><span class="p">)</span><span class="w"> </span><span class="n">T</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">æ¬¡æ•°</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></div><h2 id="è®¾å¤‡æŠ¥è­¦">è®¾å¤‡æŠ¥è­¦</h2>
<h3 id="3è®¾å¤‡æŠ¥è­¦è®°å½•æ—¶é•¿top-n">3.è®¾å¤‡æŠ¥è­¦è®°å½•æ—¶é•¿Top â€˜nâ€™</h3>
<h4 id="éœ€æ±‚åˆ†æ">éœ€æ±‚åˆ†æ</h4>
<p>å›¾è¡¨æ ·å¼&ndash;è¡¨æ ¼</p>
<p>å¯ä»¥é€‰æ‹©topçš„æ˜¯ DvcCd æˆ–è€…æ˜¯FaultDsc</p>
<p>è¿˜æœ‰TOPå¤šå°‘</p>
<p>GROUP BY FaultDsc</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="err">${</span><span class="n">textEditortopN</span><span class="err">}</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">DefectId</span><span class="p">)</span><span class="err">ç¼ºé™·æ•°é‡</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CarType</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="n">nolock</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PostId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="k">c</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="k">c</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="w"> </span><span class="o">&gt;=</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="w"> </span><span class="o">&lt;=</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxPlineNm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PlineNm</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxPlineNm}%&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxCarType}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxCarType}%&#39;</span><span class="p">)</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CarType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="err">ç¼ºé™·æ•°é‡</span><span class="w"> </span><span class="k">desc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--SQL 1.0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">DvcId</span><span class="p">,</span><span class="n">FaultDsc</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">DurationTime</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">åˆ†</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">E_EquipmentFailureInfo_Pro</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">BBdbR_DvcBase</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">DvcCd</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">DvcCd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">isFile</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">DurationTime</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">FaultDsc</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">DvcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">åˆ†</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--éªŒè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">DvcNm</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">E_EquipmentFailureInfo_Pro</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">BBdbR_DvcBase</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">DvcCd</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">DvcCd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">isFile</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">DvcNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--SQL 2.0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="err">${</span><span class="n">textEditortopN</span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">FaultDsc</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">DurationTime</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">åˆ†</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">E_EquipmentFailureInfo_Pro</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">isFile</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">DurationTime</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxPlineNm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PlineNm</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxPlineNm}%&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxCarType}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxCarType}%&#39;</span><span class="p">)</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">FaultDsc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">åˆ†</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></div><h3 id="4è®¾å¤‡æŠ¥è­¦è®°å½•æ¬¡æ•°top-n">4.è®¾å¤‡æŠ¥è­¦è®°å½•æ¬¡æ•°Top &rsquo;n'</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- è®¾å¤‡æŠ¥è­¦æ¬¡æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="err">${</span><span class="n">textEditortopN</span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DvcCd</span><span class="p">,</span><span class="n">FaultDsc</span><span class="p">,</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">æ¬¡æ•°</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">E_EquipmentFailureInfo_File</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">FaultRecTime</span><span class="w"> </span><span class="o">&gt;=</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">FaultRecTime</span><span class="w"> </span><span class="o">&lt;=</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxDvcCd}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">DvcCd</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxDvcCd}%&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">DvcCd</span><span class="p">,</span><span class="n">FaultDsc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">æ¬¡æ•°</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></div><h3 id="5è½¦èº«å·¥è‰ºå‚æ•°æŸ¥è¯¢">5.è½¦èº«å·¥è‰ºå‚æ•°æŸ¥è¯¢</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- WcNm
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">WcNm</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">BBdbR_WcBase</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w">   </span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- è®°å½• 
</span></span></span><span class="line"><span class="cl"><span class="c1">--å®ç°å‚æ•°æ¡†è”åŠ¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">P_CarProcessParametersRecord</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">  </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">[</span><span class="n">Enabled</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">GetItemTm</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="s1">&#39;${StartTm}&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="s1">&#39;${EndTm}&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">BodyNo</span><span class="w"> </span><span class="k">like</span><span class="s1">&#39;%${BodyNo}%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="s1">&#39;${BodyNo}&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">GetItemNm</span><span class="w"> </span><span class="k">like</span><span class="s1">&#39;%${GetItemNm}%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="s1">&#39;${GetItemNm}&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">WcNm</span><span class="w"> </span><span class="k">like</span><span class="s1">&#39;%${WcNm}%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="s1">&#39;${WcNm}&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">[</span><span class="n">GetItemTm</span><span class="p">]</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></div><h2 id="èƒ½æºæŠ¥è¡¨">èƒ½æºæŠ¥è¡¨</h2>
<h3 id="6å·¥å†µç´¯è®¡æµé‡-æ¯”ä¾‹åˆ†æ">6.å·¥å†µç´¯è®¡æµé‡-æ¯”ä¾‹åˆ†æ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--å‚è€ƒ ç”µåº¦-æ¯”ä¾‹åˆ†æ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">   </span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Class</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">EnergyProp</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">EnergyVal</span><span class="o">/</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">EnergyVal</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w">  </span><span class="p">[</span><span class="n">P_EquipmentEnergyConsumptionRecord</span><span class="p">]</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">EnergyNm</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;å·¥å†µç´¯è®¡æµé‡&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">E_EnergyConfig</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">Class</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">EnergyVal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">EnergyVal</span><span class="w"> </span><span class="k">FROM</span><span class="w">  </span><span class="p">[</span><span class="n">P_EquipmentEnergyConsumptionRecord</span><span class="p">]</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">EnergyNm</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;å·¥å†µç´¯è®¡æµé‡&#39;</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">Class</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Class</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="k">Class</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">Class</span><span class="w">
</span></span></span></code></pre></div><h3 id="7å·¥å†µç´¯è®¡æµé‡-è¶‹åŠ¿åˆ†æ">7.å·¥å†µç´¯è®¡æµé‡-è¶‹åŠ¿åˆ†æ</h3>
<h3 id="8æ°”-æ¯”ä¾‹åˆ†æ">8.æ°”-æ¯”ä¾‹åˆ†æ</h3>
<h3 id="9æ°”-è¶‹åŠ¿åˆ†æ">9.æ°”-è¶‹åŠ¿åˆ†æ</h3>
<h2 id="èƒ½æº">èƒ½æº</h2>
<ul>
<li>
<p>ä¸€ä¸ªè¡¨æ ¼ï¼šç®¡æ§åŒºåŸŸï¼Œç®¡æ§åŒºåŸŸåˆ†é…çš„èƒ½æºæ¯”ä¾‹ï¼Œç®¡æ§åŒºåŸŸå®é™…çš„èƒ½æºæ¯”ä¾‹</p>
</li>
<li>
<p>ä¸€ä¸ªæŠ˜çº¿å›¾ï¼šæŒ‰ç…§é€‰æ‹©çš„ç®¡æ§åŒºåŸŸå±•ç¤ºä¸€ä¸ªæœˆçš„ç”µåº¦è¶‹åŠ¿</p>
<p><figure 
	>
	<a href="/D:%5cTypora%5c%e7%ac%94%e8%ae%b0%5c%e5%b8%86%e8%bd%af%e6%8a%a5%e8%a1%a8%e7%9b%b8%e5%85%b3%5cZ--%e6%b6%82%e8%a3%85FAS%e6%8a%a5%e8%a1%a8.assets%5c1662549372222.png" >
		<img src="/D:%5cTypora%5c%e7%ac%94%e8%ae%b0%5c%e5%b8%86%e8%bd%af%e6%8a%a5%e8%a1%a8%e7%9b%b8%e5%85%b3%5cZ--%e6%b6%82%e8%a3%85FAS%e6%8a%a5%e8%a1%a8.assets%5c1662549372222.png"
			
			
			
			loading="lazy"
			alt="1662549372222">
	</a>
	
	<figcaption>1662549372222</figcaption>
	
</figure></p>
</li>
</ul>
<p>æŸ¥å‡ºæ¥è¿™ä¸ªè¡¨çš„Classå’ŒEnergyProp</p>
<p><figure 
	>
	<a href="/D:%5cTypora%5c%e7%ac%94%e8%ae%b0%5c%e5%b8%86%e8%bd%af%e6%8a%a5%e8%a1%a8%e7%9b%b8%e5%85%b3%5cZ--%e6%b6%82%e8%a3%85FAS%e6%8a%a5%e8%a1%a8.assets%5c1662549409182.png" >
		<img src="/D:%5cTypora%5c%e7%ac%94%e8%ae%b0%5c%e5%b8%86%e8%bd%af%e6%8a%a5%e8%a1%a8%e7%9b%b8%e5%85%b3%5cZ--%e6%b6%82%e8%a3%85FAS%e6%8a%a5%e8%a1%a8.assets%5c1662549409182.png"
			
			
			
			loading="lazy"
			alt="1662549409182">
	</a>
	
	<figcaption>1662549409182</figcaption>
	
</figure></p>
<p>è”åˆæŸ¥è¯¢è¿™ä¸ªè¡¨æ¡ä»¶æ˜¯Classç›¸åŒ</p>
<p><figure 
	>
	<a href="/D:%5cTypora%5c%e7%ac%94%e8%ae%b0%5c%e5%b8%86%e8%bd%af%e6%8a%a5%e8%a1%a8%e7%9b%b8%e5%85%b3%5cZ--%e6%b6%82%e8%a3%85FAS%e6%8a%a5%e8%a1%a8.assets%5c1662549449290.png" >
		<img src="/D:%5cTypora%5c%e7%ac%94%e8%ae%b0%5c%e5%b8%86%e8%bd%af%e6%8a%a5%e8%a1%a8%e7%9b%b8%e5%85%b3%5cZ--%e6%b6%82%e8%a3%85FAS%e6%8a%a5%e8%a1%a8.assets%5c1662549449290.png"
			
			
			
			loading="lazy"
			alt="1662549449290">
	</a>
	
	<figcaption>1662549449290</figcaption>
	
</figure></p>
<p>æŸ¥è¿™ä¸ªè¡¨çš„æ—¶å€™è¦æŠŠClassç›¸åŒçš„æ€»æœ‰åŠŸç”µåº¦åŠ èµ·æ¥ï¼Œå†é™¤ä»¥æ‰€æœ‰çš„æ€»æœ‰åŠŸç”µåº¦çš„å’Œï¼Œ</p>
<p><figure 
	>
	<a href="/D:%5cTypora%5c%e7%ac%94%e8%ae%b0%5c%e5%b8%86%e8%bd%af%e6%8a%a5%e8%a1%a8%e7%9b%b8%e5%85%b3%5cZ--%e6%b6%82%e8%a3%85FAS%e6%8a%a5%e8%a1%a8.assets%5c1662549517209.png" >
		<img src="/D:%5cTypora%5c%e7%ac%94%e8%ae%b0%5c%e5%b8%86%e8%bd%af%e6%8a%a5%e8%a1%a8%e7%9b%b8%e5%85%b3%5cZ--%e6%b6%82%e8%a3%85FAS%e6%8a%a5%e8%a1%a8.assets%5c1662549517209.png"
			
			
			
			loading="lazy"
			alt="1662549517209">
	</a>
	
	<figcaption>1662549517209</figcaption>
	
</figure></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">---ç”µåº¦è¶‹åŠ¿å›¾
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">every_time</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">æ—¥æœŸ</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">Class</span><span class="p">,</span><span class="s1">&#39;${Class}&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">ç®¡æ§åŒºåŸŸåŒºåŸŸ</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="n">EnergyVal</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">ç”µåº¦</span><span class="w"> </span><span class="k">FROM</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CONVERT</span><span class="w"> </span><span class="p">(</span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="n">dateadd</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span><span class="nb">number</span><span class="p">,</span><span class="w"> </span><span class="n">dateadd</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span><span class="o">-</span><span class="k">day</span><span class="p">(</span><span class="n">getdate</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">getdate</span><span class="p">())),</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">every_time</span><span class="w"> </span><span class="c1">--æ—¥æœŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">master</span><span class="p">..</span><span class="n">spt_values</span><span class="w"> </span><span class="n">n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">n</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;p&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="nb">number</span><span class="o">&lt;</span><span class="n">datediff</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="n">dateadd</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span><span class="o">-</span><span class="k">day</span><span class="p">(</span><span class="n">getdate</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">getdate</span><span class="p">()),</span><span class="n">dateadd</span><span class="p">(</span><span class="n">mm</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">dateadd</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span><span class="o">-</span><span class="k">day</span><span class="p">(</span><span class="n">getdate</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">getdate</span><span class="p">())))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="n">R</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">select</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Class</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">EnergyVal</span><span class="p">,</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="k">as</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">P_EquipmentEnergyConsumptionRecord_File</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">E_EnergyConfig</span><span class="w"> </span><span class="n">b</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">ON</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Class</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="k">Class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${Class}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Class</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${Class}%&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">EnergyNm</span><span class="o">=</span><span class="s1">&#39;æ€»æœ‰åŠŸç”µåº¦&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">AND</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">DateName</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">))</span><span class="o">=</span><span class="mi">20</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">DateName</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">))</span><span class="o">=</span><span class="mi">20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">AND</span><span class="w"> </span><span class="k">Day</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">Day</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">31</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Class</span><span class="p">,</span><span class="n">EnergyVal</span><span class="p">,</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="n">TAB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">TAB</span><span class="p">.</span><span class="n">t</span><span class="o">=</span><span class="n">R</span><span class="p">.</span><span class="n">every_time</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">every_time</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="err">ä¸€ä¸ªè¡¨æ ¼ï¼šç®¡æ§åŒºåŸŸï¼Œç®¡æ§åŒºåŸŸåˆ†é…çš„èƒ½æºæ¯”ä¾‹ï¼Œç®¡æ§åŒºåŸŸå®é™…çš„èƒ½æºæ¯”ä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Class</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">EnergyProp</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">EnergyVal</span><span class="o">/</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">EnergyVal</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w">  </span><span class="p">[</span><span class="n">P_EquipmentEnergyConsumptionRecord</span><span class="p">]</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">EnergyNm</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;æ€»æœ‰åŠŸç”µåº¦&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">E_EnergyConfig</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">Class</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">EnergyVal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">EnergyVal</span><span class="w"> </span><span class="k">FROM</span><span class="w">  </span><span class="p">[</span><span class="n">P_EquipmentEnergyConsumptionRecord</span><span class="p">]</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">EnergyNm</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;æ€»æœ‰åŠŸç”µåº¦&#39;</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">Class</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">Class</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="k">Class</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">Class</span><span class="w">
</span></span></span></code></pre></div><h3 id="ç”Ÿäº§æŠ¥è¡¨">ç”Ÿäº§æŠ¥è¡¨</h3>
<h3 id="jph">JPH</h3>
<ul>
<li>
<p>æ³¨é‡Šæ—¶é—´
å»é‡ï¼Ÿæ˜¯ç«™ç‚¹å»é‡å˜›ï¼Ÿ
ä¸æ˜¯æœ‰è¿‡ç‚¹ä¿¡æ¯å°±å±•ç¤º éœ€è¦å±•ç¤ºæ‰€æœ‰çš„ç«™ç‚¹ä¿¡æ¯ æ²¡æœ‰è¿‡ç‚¹ä¿¡æ¯çš„å±•ç¤ºä¸º0 abç‚¹åªå–ä¸€ä¸ªç‚¹</p>
</li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--Jphä¸ºå½“å¤©çš„å¹³å‡æ¯å°æ—¶äº§é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">AviNm</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="n">BodyNo</span><span class="p">)</span><span class="err">è¿‡ç‚¹æ•°é‡</span><span class="p">,</span><span class="err">æ—¶é—´</span><span class="o">=</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">datediff</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="n">PastTime</span><span class="p">,</span><span class="s1">&#39;2022-05-15&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">AviNm</span><span class="p">,</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--æ—¶é—´ç­›æŸ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="err">æ—¶é—´</span><span class="o">=</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">datediff</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="n">PastTime</span><span class="p">,</span><span class="s1">&#39;2022-05-15&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--æ—¶é—´ç­›æŸ¥2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="err">æ—¶é—´</span><span class="o">=</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">PastTime</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="s1">&#39;2022-05-15 08:00:00&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">DATEADD</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2022-05-15 08:00:00&#39;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">AviNm</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_AVIBase</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_638&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_636&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_619&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_621&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_606&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_610&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_602&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_614&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_641&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_605&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_655&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_644&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_645&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_646&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_647&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_648&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_649&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_650&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å°è¯•1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="n">BodyNo</span><span class="p">)</span><span class="err">è¿‡ç‚¹æ•°é‡</span><span class="p">,</span><span class="err">æ—¶é—´</span><span class="o">=</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_AVIBase</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">AviId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_638&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_636&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_619&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_621&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_606&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_610&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_602&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_614&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_641&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_605&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_655&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_644&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_645&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_646&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_647&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_648&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_649&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_650&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">PastTime</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="s1">&#39;2022-05-15 08:00:00&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">DATEADD</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2022-05-15 08:00:00&#39;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="p">,</span><span class="n">PastTime</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å°è¯•2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="n">BodyNo</span><span class="p">)</span><span class="err">è¿‡ç‚¹æ•°é‡</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_AVIBase</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">AviId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_638&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_636&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_619&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_621&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_606&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_610&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_602&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_614&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_641&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_605&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_655&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_644&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_645&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_646&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_647&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_648&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_649&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_650&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å°è¯•3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">COUNT</span><span class="p">(</span><span class="n">BodyNo</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span><span class="err">è¿‡ç‚¹æ•°é‡</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_AVIBase</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">AviId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">PastTime</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="s1">&#39;2022-05-15 08:00:00&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">DATEADD</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2022-05-15 08:00:00&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">and</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_638&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_636&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_619&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_621&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_606&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_610&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_602&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_614&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_641&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_605&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_655&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_644&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_645&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_646&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_647&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_648&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_649&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_650&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å°è¯•4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="p">,</span><span class="err">æ—¶é—´</span><span class="o">=</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_AVIBase</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">AviId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_638&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_636&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_619&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_621&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_606&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_610&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_602&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_614&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_641&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_605&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_655&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_644&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_645&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_646&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_647&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_648&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_649&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_650&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="p">,</span><span class="n">PastTime</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å°è¯•5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">AviNm</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="err">è¿‡ç‚¹æ•°é‡</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="err">è¿‡ç‚¹æ•°é‡</span><span class="w"> </span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_AVIBase</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">AviId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_638&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_636&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_619&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_621&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_606&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_610&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_602&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_614&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_641&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_605&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_655&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_644&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_645&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_646&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_647&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_648&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_649&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_650&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="p">,</span><span class="k">COUNT</span><span class="p">(</span><span class="n">BodyNo</span><span class="p">)</span><span class="err">è¿‡ç‚¹æ•°é‡</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_AVIBase</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">AviId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">PastTime</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="s1">&#39;2022-05-15 08:00:00&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">DATEADD</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2022-05-15 08:00:00&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">and</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_638&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_636&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_619&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_621&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_606&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;AVI_610&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_602&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_614&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_641&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_605&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_655&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_644&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_645&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_646&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_647&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_648&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_649&#39;</span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviCd</span><span class="o">!=</span><span class="s1">&#39;AVI_650&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">AviNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">T</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">A</span><span class="p">.</span><span class="n">AviNm</span><span class="o">=</span><span class="n">T</span><span class="p">.</span><span class="n">AviNm</span><span class="w">
</span></span></span></code></pre></div></li>
</ul>
<h3 id="ç”Ÿäº§æ—¥æŠ¥">ç”Ÿäº§æ—¥æŠ¥</h3>
<ul>
<li>
<p>å…«ç‚¹0000000åˆ°ç¬¬äºŒå¤©ä¸ƒç‚¹59.59.59</p>
</li>
<li>
<p>è¯´æ˜ä¹Ÿè¦åŠ  ç®—æ³•ä¹ŸåŠ 
ä¸è¦è½¦å‹é€‰æ‹©æ§ä»¶ æŒ‰ç…§æ—¥æœŸæŸ¥è¯¢å±•ç¤ºæ‰€æœ‰è½¦å‹
å®é™…ä¸Šä¸‹çº¿ä¸åœ¨ä¸€åˆ—</p>
</li>
<li>
<p>å¹´æœˆæ—¥ä¸‰å¼ æŠ¥è¡¨</p>
<h2 id="ç”Ÿäº§æœˆæŠ¥20">ç”Ÿäº§æœˆæŠ¥2.0</h2>
</li>
<li>
<p>SQLè¯­å¥1</p>
</li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">USE</span><span class="w"> </span><span class="p">[</span><span class="n">JAC_PaintingFAS</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/****** Object:  UserDefinedFunction [dbo].[produceYear]    Script Date: 2022/6/22 15:41:54 ******/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">produceYear</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">SearchYear</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="o">@</span><span class="n">AviCd</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURNS</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="k">Table</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	 </span><span class="n">indexrow</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">CarType</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="n">Num</span><span class="w"> </span><span class="nb">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_START</span><span class="w"> </span><span class="n">datetime</span><span class="o">=</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="o">@</span><span class="n">SearchYear</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-01-01 00:00:00.000&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w">	</span><span class="o">@</span><span class="n">DATE_ENDadd</span><span class="w"> </span><span class="n">datetime</span><span class="o">=</span><span class="n">dateadd</span><span class="w"> </span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">@</span><span class="n">DATE_START</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w">	</span><span class="o">@</span><span class="n">DATE_END</span><span class="w"> </span><span class="n">datetime</span><span class="o">=</span><span class="n">dateadd</span><span class="w"> </span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">@</span><span class="n">DATE_ENDadd</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">IndexTable</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">DateInfo</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">			
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">BeforeData</span><span class="w"> </span><span class="k">table</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	 </span><span class="n">indexrow</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">CarType</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="n">Num</span><span class="w"> </span><span class="nb">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">		
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">[</span><span class="n">AviCd</span><span class="p">]</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">CarType</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">[</span><span class="n">PastTime</span><span class="p">]</span><span class="w"> </span><span class="n">datetime</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">IndexTable</span><span class="w">  </span><span class="c1">--æ¯æœˆX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">		</span><span class="k">SELECT</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">char</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="w"> </span><span class="nb">number</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_START</span><span class="p">),</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">DATA_DATE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">FROM</span><span class="w">    </span><span class="n">master</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">spt_values</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="n">spt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">WHERE</span><span class="w">   </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;p&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_START</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_END</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="w"> </span><span class="p">[</span><span class="n">AviCd</span><span class="p">],</span><span class="n">CarType</span><span class="p">,[</span><span class="n">PastTime</span><span class="p">]</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w">		
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">where</span><span class="w"> </span><span class="p">[</span><span class="n">PastTime</span><span class="p">]</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_START</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_END</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">BeforeData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span><span class="n">CarType</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="p">[</span><span class="n">AviCd</span><span class="p">]</span><span class="o">=@</span><span class="n">AviCd</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span><span class="n">CarType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">--å£°æ˜ä¸€ä¸ªæ¸¸æ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">		</span><span class="k">declare</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">CURSOR</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">DateInfo</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">IndexTable</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		 </span><span class="c1">--æ‰“å¼€æ¸¸æ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">			</span><span class="k">open</span><span class="w"> </span><span class="n">dy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">--æå–æ¸¸æ ‡1ç¬¬ä¸€è¡Œå†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">			</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">--å¾ªç¯æå–æ¸¸æ ‡1å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">			</span><span class="n">WHILE</span><span class="w"> </span><span class="o">@@</span><span class="n">FETCH_STATUS</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">col</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="c1">--æ¯å¤©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">					</span><span class="o">@</span><span class="k">IsNull</span><span class="w">	</span><span class="nb">int</span><span class="w">				
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">select</span><span class="w"> </span><span class="o">@</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateInfo</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">IndexTable</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">DateInfo</span><span class="o">=@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">IsNull</span><span class="o">=</span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">BeforeData</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">indexrow</span><span class="o">=@</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="k">IsNull</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">begin</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="p">(</span><span class="n">indexrow</span><span class="p">,</span><span class="n">CarType</span><span class="p">,</span><span class="n">Num</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">col</span><span class="p">,</span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">else</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">begin</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="k">Data</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">BeforeData</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">indexrow</span><span class="o">=@</span><span class="n">col</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">CLOSE</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="c1">--å…³é—­æ¸¸æ ‡ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="c1">--é‡Šæ”¾æ¸¸æ ‡èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">RETURN</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>SQLè¯­å¥1.1</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">USE</span><span class="w"> </span><span class="p">[</span><span class="n">JAC_PaintingFAS</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/****** Object:  UserDefinedFunction [dbo].[produceYear]    Script Date: 2022/6/22 15:54:11 ******/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">produceYear</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">SearchYear</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURNS</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="k">Table</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	 </span><span class="n">indexrow</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">CarType</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="n">Num</span><span class="w"> </span><span class="nb">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_START</span><span class="w"> </span><span class="n">datetime</span><span class="o">=</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="o">@</span><span class="n">SearchYear</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-01-01 00:00:00.000&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w">	</span><span class="o">@</span><span class="n">DATE_ENDadd</span><span class="w"> </span><span class="n">datetime</span><span class="o">=</span><span class="n">dateadd</span><span class="w"> </span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">@</span><span class="n">DATE_START</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w">	</span><span class="o">@</span><span class="n">DATE_END</span><span class="w"> </span><span class="n">datetime</span><span class="o">=</span><span class="n">dateadd</span><span class="w"> </span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">@</span><span class="n">DATE_ENDadd</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">IndexTable</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">DateInfo</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">			
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">BeforeData</span><span class="w"> </span><span class="k">table</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	 </span><span class="n">indexrow</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">CarType</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="n">Num</span><span class="w"> </span><span class="nb">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">		 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">CarType</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">[</span><span class="n">PastTime</span><span class="p">]</span><span class="w"> </span><span class="n">datetime</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">IndexTable</span><span class="w">  </span><span class="c1">--æ¯æœˆX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">		</span><span class="k">SELECT</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">char</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="w"> </span><span class="nb">number</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_START</span><span class="p">),</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">DATA_DATE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">FROM</span><span class="w">    </span><span class="n">master</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">spt_values</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="n">spt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">WHERE</span><span class="w">   </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;p&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_START</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_END</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="w"> </span><span class="n">CarType</span><span class="p">,[</span><span class="n">PastTime</span><span class="p">]</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w">		
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">where</span><span class="w"> </span><span class="p">[</span><span class="n">PastTime</span><span class="p">]</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_START</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="o">@</span><span class="n">DATE_END</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">BeforeData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span><span class="n">CarType</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span><span class="n">CarType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">--å£°æ˜ä¸€ä¸ªæ¸¸æ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">		</span><span class="k">declare</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">CURSOR</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">DateInfo</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">IndexTable</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		 </span><span class="c1">--æ‰“å¼€æ¸¸æ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">			</span><span class="k">open</span><span class="w"> </span><span class="n">dy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">--æå–æ¸¸æ ‡1ç¬¬ä¸€è¡Œå†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">			</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">--å¾ªç¯æå–æ¸¸æ ‡1å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">			</span><span class="n">WHILE</span><span class="w"> </span><span class="o">@@</span><span class="n">FETCH_STATUS</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">col</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="c1">--æ¯å¤©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">					</span><span class="o">@</span><span class="k">IsNull</span><span class="w">	</span><span class="nb">int</span><span class="w">				
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">select</span><span class="w"> </span><span class="o">@</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateInfo</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">IndexTable</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">DateInfo</span><span class="o">=@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">IsNull</span><span class="o">=</span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">BeforeData</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">indexrow</span><span class="o">=@</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="k">IsNull</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">begin</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="p">(</span><span class="n">indexrow</span><span class="p">,</span><span class="n">CarType</span><span class="p">,</span><span class="n">Num</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">col</span><span class="p">,</span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">else</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">begin</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="k">Data</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">BeforeData</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">indexrow</span><span class="o">=@</span><span class="n">col</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">CLOSE</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="c1">--å…³é—­æ¸¸æ ‡ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="c1">--é‡Šæ”¾æ¸¸æ ‡èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">RETURN</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>SQLè¯­å¥&ndash;datachart</p>
</li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;01-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;02-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;03-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;04-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;05-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;06-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;07-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;08-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;09-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;10-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;11-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">daycol</span><span class="p">))</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;12-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--from fineReportDailyTable(&#39;${searchDate}&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">cartype</span><span class="w"> </span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>SQLè¯­å¥</p>
</li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">)</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">sum</span><span class="p">(</span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">)</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="w"> </span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">daycol</span><span class="w"> </span><span class="err">æœˆä»½</span><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;01-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;01-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;02-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;02-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;03-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;03-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;04-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;04-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;05-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;05-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;06-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;06-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;07-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;07-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;08-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;08-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;09-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;09-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;10-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;10-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;11-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;11-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">union</span><span class="w"> </span><span class="k">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">ISNULL</span><span class="p">(</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">onlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸Šçº¿</span><span class="p">,</span><span class="k">ISNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">offlinenum</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="k">as</span><span class="w"> </span><span class="err">å®é™…ä¸‹çº¿</span><span class="p">,</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">MONTH</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;12-01&#39;</span><span class="p">,</span><span class="mi">120</span><span class="p">)))</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;12-01&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">daycol</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">daycol</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div></li>
<li></li>
</ul>
<h2 id="è´¨é‡æŠ¥è¡¨">è´¨é‡æŠ¥è¡¨</h2>
<h3 id="ftt">FTT</h3>
<ul>
<li>è¯´æ˜ï¼šè®¡ç®—FTTå…¬å¼ï¼šï¼ˆæ€»æ•°é‡-ä¸åˆæ ¼æ•°é‡ï¼‰/æ€»æ•°æ®ã€‚å…¶ä¸­æ€»æ•°é‡ä¸ºè¿™ä¸€æ®µæ—¶é—´å†…è¿‡ç‚¹è½¦è¾†ï¼Œä¸”åœ¨è¿™æ®µæ—¶é—´ä¹‹å‰æ²¡æœ‰è¿‡ç‚¹ï¼Œå¦‚æœè½¦è¾†è¿‡äº†ä¸¤æ¬¡æˆ–ä¸¤æ¬¡ä»¥ä¸Šåªç®—1æ¬¡ï¼Œä¸”å–çš„æ˜¯ç¬¬ä¸€æ¬¡è¿‡ç‚¹çš„æ•°æ®ã€‚ä¸åˆæ ¼æ•°æ®ä¸ºè¿™æ®µæ—¶é—´å†…ï¼Œè¿‡ç‚¹è½¦è¾†ä½†æ˜¯ä»»ç„¶æœ‰æœªä¿®å¤çš„ç¼ºé™·+è¿‡ç‚¹è½¦è¾†ç¼ºé™·ä¹Ÿå·²ç»ä¿®å¤ä½†æ˜¯æ˜¯åœ¨ä¸‹çº¿ï¼ˆä¸‹çº¿AVIç«™ç‚¹ï¼Œå¯¹äºæ²¡æœ‰ä¸‹çº¿AVIç«™ç‚¹çš„å–çš„æ˜¯ä¸Šçº¿AVIç«™ç‚¹ï¼‰ä¹‹åä¿®å¤çš„ã€‚</li>
</ul>
<h3 id="dpu">DPU</h3>
<ul>
<li>DPUè®¡ç®—å…¬è¯•ï¼šç¼ºé™·æ€»æ•°/è½¦è¾†æ€»æ•°ã€‚ç¼ºé™·æ€»æ•°ä¸ºè¿™æ®µæ—¶é—´å†…è¯¥çº¿ä½“å‘ç”Ÿçš„ç¼ºé™·æ€»åˆã€‚è½¦è¾†æ€»æ•°ä¸ºè¿™æ®µæ—¶é—´å†…ç¬¬ä¸€æ¬¡ç»è¿‡è¯¥çº¿ä½“AVIç«™ç‚¹çš„è½¦è¾†ï¼ŒåŒä¸€è¾†è½¦é‡å¤æˆ–å¤šæ¬¡å¤šç‚¹åªç®—ä¸€æ¬¡ã€‚</li>
</ul>
<h1 id="ç”Ÿäº§æŠ¥è¡¨-1">ç”Ÿäº§æŠ¥è¡¨</h1>
<h2 id="sqlè¯­å¥">SQLè¯­å¥</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--å»ºè¡¨è¯­å¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">USE</span><span class="w"> </span><span class="p">[</span><span class="n">JAC_PaintingFAS</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/****** Object:  UserDefinedFunction [dbo].[fineReportDailyTable]    Script Date: 2022/5/18 9:30:20 ******/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">fineReportDailyTable</span><span class="p">]</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">searchDate</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURNS</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="k">Table</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	 </span><span class="n">rowindex</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="n">daycol</span><span class="w"> </span><span class="n">datetime</span><span class="p">,</span><span class="n">cartype</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">plannum</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="n">onlinenum</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="n">offlinenum</span><span class="w"> </span><span class="nb">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--å£°æ˜è¡¨å˜é‡ä¸´æ—¶å­˜å‚¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">cartype</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="c1">--è½¦å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">planonline</span><span class="w"> </span><span class="nb">int</span><span class="c1">--è®¡åˆ’ä¸Šçº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">actonline</span><span class="w"> </span><span class="nb">int</span><span class="c1">--å®é™…ä¸Šçº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">actoffline</span><span class="w"> </span><span class="nb">int</span><span class="c1">--å®é™…ä¸‹çº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">dayData</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">daycol</span><span class="w"> </span><span class="n">datetime</span><span class="c1">--æœˆä¸­çš„æ¯å¤©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">		</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">CarTpData</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">cartyp</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="c1">--è½¦å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">		</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">dayData</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="o">@</span><span class="n">searchDate</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="nb">number</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">datetime</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">daycol</span><span class="w"> </span><span class="k">from</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">master</span><span class="p">..</span><span class="n">spt_values</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">type</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="nb">number</span><span class="p">,</span><span class="k">cast</span><span class="p">(</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="o">@</span><span class="n">searchDate</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-01&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">datetime</span><span class="p">))</span><span class="o">&lt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DATEADD</span><span class="p">(</span><span class="k">MONTH</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="k">cast</span><span class="p">(</span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="o">@</span><span class="n">searchDate</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-01&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">datetime</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">CarTpData</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="k">left</span><span class="p">(</span><span class="n">CarType</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cartyp</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="n">PastTime</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">searchDate</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">left</span><span class="p">(</span><span class="n">CarType</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="k">index</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="c1">--åºå·å»ºç«‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">index</span><span class="o">=</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--å£°æ˜ä¸€ä¸ªæ¸¸æ ‡1,2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">CURSOR</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">daycol</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">dayData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="k">CURSOR</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">cartyp</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">CarTpData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">--æ‰“å¼€æ¸¸æ ‡1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">open</span><span class="w"> </span><span class="n">dy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--æå–æ¸¸æ ‡1ç¬¬ä¸€è¡Œå†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w"> </span><span class="n">datetime</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--å¾ªç¯æå–æ¸¸æ ‡1å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">WHILE</span><span class="w"> </span><span class="o">@@</span><span class="n">FETCH_STATUS</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">col</span><span class="w"> </span><span class="n">datetime</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">select</span><span class="w"> </span><span class="o">@</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daycol</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">dayData</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">daycol</span><span class="o">=@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--æ‰“å¼€æ¸¸æ ‡2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">open</span><span class="w"> </span><span class="n">car</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--æå–æ¸¸æ ‡2ç¬¬ä¸€è¡Œå†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--å¾ªç¯æå–æ¸¸æ ‡2å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">WHILE</span><span class="w"> </span><span class="o">@@</span><span class="n">FETCH_STATUS</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="k">begin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="k">select</span><span class="w"> </span><span class="o">@</span><span class="n">cartype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cartyp</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">CarTpData</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">cartyp</span><span class="o">=@</span><span class="n">cartyp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="n">planonline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_ProducePlan_Pro</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PlanTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">@</span><span class="n">col</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="k">and</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="n">actonline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">@</span><span class="n">col</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="k">and</span><span class="w"> </span><span class="n">AviCd</span><span class="o">=</span><span class="s1">&#39;AVI_601&#39;</span><span class="p">)</span><span class="w">	 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="n">actoffline</span><span class="w"> </span><span class="o">=</span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">@</span><span class="n">col</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="k">and</span><span class="w"> </span><span class="n">AviCd</span><span class="o">=</span><span class="s1">&#39;AVI_655&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="p">(</span><span class="n">rowindex</span><span class="p">,</span><span class="n">daycol</span><span class="p">,</span><span class="n">cartype</span><span class="p">,</span><span class="n">plannum</span><span class="p">,</span><span class="n">onlinenum</span><span class="p">,</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="k">index</span><span class="p">,</span><span class="o">@</span><span class="n">col</span><span class="p">,</span><span class="o">@</span><span class="n">cartype</span><span class="p">,</span><span class="o">@</span><span class="n">planonline</span><span class="p">,</span><span class="o">@</span><span class="n">actonline</span><span class="p">,</span><span class="o">@</span><span class="n">actoffline</span><span class="p">)</span><span class="w">	  	   
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="k">CLOSE</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="c1">--å…³é—­æ¸¸æ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	  </span><span class="c1">--DEALLOCATE car  --é‡Šæ”¾æ¸¸æ ‡èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	  </span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="k">index</span><span class="o">+</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">daycol</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">END</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CLOSE</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="c1">--å…³é—­æ¸¸æ ‡ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="c1">--é‡Šæ”¾æ¸¸æ ‡èµ„æº	
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="n">car</span><span class="w">  </span><span class="c1">--é‡Šæ”¾æ¸¸æ ‡èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">RETURN</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--æœ‰è¯¯-æœˆæŠ¥å¤šè¯­å¥å»ºè¡¨å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">USE</span><span class="w"> </span><span class="p">[</span><span class="n">JAC_PaintingFAS</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/****** Object:  UserDefinedFunction [dbo].[fineReportDailyTable]    Script Date: 2022/5/18 9:50:33 ******/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">fineReportMonthTable</span><span class="p">]</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">searchDate</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURNS</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="k">Table</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	 </span><span class="n">rowindex</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="p">,</span><span class="n">cartype</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">plannum</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="n">onlinenum</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="n">offlinenum</span><span class="w"> </span><span class="nb">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--å£°æ˜è¡¨å˜é‡ä¸´æ—¶å­˜å‚¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">cartype</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="c1">--è½¦å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">planonline</span><span class="w"> </span><span class="nb">int</span><span class="c1">--è®¡åˆ’ä¸Šçº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">actonline</span><span class="w"> </span><span class="nb">int</span><span class="c1">--å®é™…ä¸Šçº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">actoffline</span><span class="w"> </span><span class="nb">int</span><span class="c1">--å®é™…ä¸‹çº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">CarTpData</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">cartyp</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="c1">--è½¦å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">		</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">CarTpData</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="k">left</span><span class="p">(</span><span class="n">CarType</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cartyp</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="n">PastTime</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">searchDate</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">left</span><span class="p">(</span><span class="n">CarType</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="k">index</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="c1">--åºå·å»ºç«‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">index</span><span class="o">=</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--å£°æ˜ä¸€ä¸ªæ¸¸æ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="k">CURSOR</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">cartyp</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">CarTpData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--æ‰“å¼€æ¸¸æ ‡2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">open</span><span class="w"> </span><span class="n">car</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--æå–æ¸¸æ ‡2ç¬¬ä¸€è¡Œå†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">--å¾ªç¯æå–æ¸¸æ ‡2å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">WHILE</span><span class="w"> </span><span class="o">@@</span><span class="n">FETCH_STATUS</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="k">begin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="k">select</span><span class="w"> </span><span class="o">@</span><span class="n">cartype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cartyp</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">CarTpData</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">cartyp</span><span class="o">=@</span><span class="n">cartyp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="n">planonline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_ProducePlan_Pro</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PlanTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PlanTime</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="n">actonline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="k">and</span><span class="w"> </span><span class="n">AviCd</span><span class="o">=</span><span class="s1">&#39;AVI_601&#39;</span><span class="p">)</span><span class="w">	 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="n">actoffline</span><span class="w"> </span><span class="o">=</span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastRecordInfo</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">PastTime</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="k">and</span><span class="w"> </span><span class="n">AviCd</span><span class="o">=</span><span class="s1">&#39;AVI_655&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="p">(</span><span class="n">rowindex</span><span class="p">,</span><span class="n">cartype</span><span class="p">,</span><span class="n">plannum</span><span class="p">,</span><span class="n">onlinenum</span><span class="p">,</span><span class="n">offlinenum</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="k">index</span><span class="p">,</span><span class="o">@</span><span class="n">cartype</span><span class="p">,</span><span class="o">@</span><span class="n">planonline</span><span class="p">,</span><span class="o">@</span><span class="n">actonline</span><span class="p">,</span><span class="o">@</span><span class="n">actoffline</span><span class="p">)</span><span class="w">	  	   
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">cartyp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="k">CLOSE</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="c1">--å…³é—­æ¸¸æ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	  </span><span class="c1">--DEALLOCATE car  --é‡Šæ”¾æ¸¸æ ‡èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	  </span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="k">index</span><span class="o">+</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="n">car</span><span class="w">  </span><span class="c1">--é‡Šæ”¾æ¸¸æ ‡èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">RETURN</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="w">
</span></span></span></code></pre></div><p>é—®é¢˜ç‚¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="s1">&#39;2022-05-04&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">fineReportDailyTable</span><span class="p">(</span><span class="s1">&#39;${searchDate}&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span></code></pre></div><p>sqlè¯­å¥ï¼šå¤šè¯­å¥å»ºè¡¨å‡½æ•°ä¸ºä»€ä¹ˆselect * æ˜¯æŒ‰ç…§è½¦å‹ï¼ˆåŠ ç©ºç™½å…±å…­ç§è½¦å‹ï¼‰åˆ†ç»„ å…±31ç»„ è¿™ä¸ªæ•°æ®å°±å¾ˆå¥‡æ€ªï¼›</p>
<p>select sum ä¹Ÿå°±æ˜¯ä¸å¤ªå¯¹äº†</p>
<h1 id="è´¨é‡æŠ¥è¡¨-1">è´¨é‡æŠ¥è¡¨</h1>
<h2 id="æ•°æ®æŸ¥è¯¢">æ•°æ®æŸ¥è¯¢</h2>
<ul>
<li>
<p>ä¸€äº›æ‘˜æŠ„ï¼š</p>
<p>éœ€å¾—åšå¥½è¯¥åšçš„ä»ä¸­è·å–ä»·å€¼æ„ä¹‰ ç„¶åå†å»å¿ƒå®‰ç†å¾—çš„å»åšæ— æ„ä¹‰åˆæ„‰æ‚¦èº«å¿ƒçš„äº‹ æ‰å«é—²æš‡</p>
<p>ç›¸å å¦‚æœé—²æš‡æ˜¯å»ºç«‹åœ¨æ‘’å¼ƒä¸€åˆ‡æœ‰ä»·å€¼æœ‰æ„ä¹‰çš„äº‹ç‰©èººä¸‹ åˆ™å…¨ç„¶ä¸è§‰å¾—æ„‰å¿«</p>
</li>
<li>
<p>è½¦èº«è´¨é‡æ£€æŸ¥è¿‡ç¨‹è¡¨ï¼šæ‰€æœ‰è¿‡æ£€è½¦è¾†çš„ä¿¡æ¯è®°å½•&mdash;è¿‡æ£€è½¦è¾†æ€»æ•°</p>
</li>
<li>
<p>è½¦èº«éƒ¨ä½è´¨æ£€ç¼ºé™·è¿‡ç¨‹è¡¨ï¼šè¿‡æ£€åå‡ºç°é—®é¢˜çš„è½¦è¾†å…·ä½“ç¼ºé™·ä¿¡æ¯&mdash;ç¼ºé™·é—®é¢˜æ•°</p>
</li>
<li>
<p>è½¦èº«è´¨é‡æ£€æŸ¥é”€é¡¹è¿‡ç¨‹è¡¨ï¼šæœ‰é—®é¢˜è½¦è¾†çš„ä¿®ç†æ•°æ®è®°å½•</p>
</li>
<li>
<p>ç¼ºé™·é—®é¢˜ç‚¹åˆ†ç±»è¡¨ï¼šå°†æ£€æŸ¥åˆ°çš„ç¼ºé™·é—®é¢˜æŒ‰ç…§å›ºå®šç±»åˆ«è¿›è¡Œåˆ†ç±»</p>
</li>
</ul>
<h2 id="è”åˆæŸ¥è¯¢-å­—æ®µå¯¹åº”">è”åˆæŸ¥è¯¢ å­—æ®µå¯¹åº”</h2>
<ul>
<li>1.äº§çº¿åŸºç¡€ä¿¡æ¯è¡¨ï¼šäº§çº¿ä¸»é”®&ndash;PlineIdï¼›äº§çº¿åç§°&ndash;PlineNm</li>
<li>2.å·¥ä½åŸºç¡€ä¿¡æ¯è¡¨ï¼šäº§çº¿ä¸»é”®&ndash;PlineIdï¼›å·¥ä½ä¸»é”®&ndash;WcId</li>
<li>3.è½¦èº«è´¨é‡è¿‡ç¨‹è¡¨ï¼šè´¨æ§ç‚¹ä¸»é”®&ndash;WcId</li>
<li>4.è½¦èº«éƒ¨ä½è´¨æ£€ç¼ºé™·è¿‡ç¨‹è¡¨ï¼šè´¨æ§ç‚¹ä¸»é”®&ndash;WcIdï¼›ï¼šç¼ºé™·ä¸»é”®&ndash;DefectId</li>
<li>5.ç¼ºé™·é—®é¢˜ç‚¹åˆ†ç±»è¡¨ï¼šç¼ºé™·ä¸»é”®&ndash;DefectId</li>
</ul>
<h2 id="é€»è¾‘åˆ†æ">é€»è¾‘åˆ†æ</h2>
<h3 id="è´¨é‡topåˆ†ç±»dpu">è´¨é‡TOPåˆ†ç±»DPU</h3>
<ul>
<li>
<p>æ•°æ®é›†è¦æ±‚ï¼š</p>
<p>äº§çº¿-ç¼ºé™·æ•°é‡-è½¦å‹-åˆ›å»ºæ—¶é—´-ç¼ºé™·åç§°-è¿‡æ£€è½¦è¾†æ•°ç›®</p>
</li>
<li>
<p>SQLè¯­å¥ï¼š</p>
<p>å¤šè¡¨è”åˆæŸ¥è¯¢ï¼šç¼ºé™·æ•°é‡è”åˆæŸ¥è¯¢ï¼›</p>
<p>è¿‡æ£€è½¦è¾†æ•°è”åˆæŸ¥è¯¢</p>
</li>
</ul>
<h3 id="å•ç‚¹é—®é¢˜è¶‹åŠ¿">å•ç‚¹é—®é¢˜è¶‹åŠ¿</h3>
<ul>
<li>
<p>æ•°æ®å¤„ç†é—®é¢˜ç‚¹</p>
<p>æ²¡æœ‰ç»Ÿè®¡è½¦èº«è´¨é‡æ£€æŸ¥è¿‡ç¨‹è¡¨æ•°æ®ï¼Œåªè”åˆè½¦èº«éƒ¨ä½è´¨æ£€ç¼ºé™·è¿‡ç¨‹è¡¨ã€äº§çº¿åŸºç¡€ä¿¡æ¯è¡¨ã€å·¥ä½åŸºç¡€ä¿¡æ¯è¡¨ä¸‰è¡¨æŸ¥è¯¢ã€‚è¿‡ç‚¹è½¦è¾†æ•°ä¸ºcount(CarType)ã€å½“æ—¥ç¼ºé™·æ•°ä¸ºcount(DefectId)ä¸”Enabled=&lsquo;1&rsquo;</p>
</li>
</ul>
<h2 id="sqlè¯­å¥å­˜æ¡£">SQLè¯­å¥å­˜æ¡£</h2>
<h3 id="è´¨é‡topåˆ†ç±»dpuåŠå•ç‚¹é—®é¢˜è¶‹åŠ¿">è´¨é‡TOPåˆ†ç±»DPUåŠå•ç‚¹é—®é¢˜è¶‹åŠ¿</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--ç¼ºé™·æ•°é‡åŠè¿‡æ£€è½¦è¾†æ•°ï¼ˆæ— å…³äº§çº¿ã€æ—¶é—´ã€è½¦å‹ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">BodyNo</span><span class="p">)</span><span class="err">å½“æ—¥è¿‡æ£€è½¦è¾†æ€»æ•°</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="n">DefectId</span><span class="p">)</span><span class="err">å½“æ—¥ç¼ºé™·æ€»æ•°</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å½“æ—¥è¿‡æ£€è½¦è¾†æ€»æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">BodyNo</span><span class="p">)</span><span class="err">å½“æ—¥è¿‡æ£€è½¦è¾†æ€»æ•°</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">---ç¼ºé™·æ•°é‡è”åˆæŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">DefectId</span><span class="p">)</span><span class="err">å½“æ—¥ç¼ºé™·æ•°é‡</span><span class="p">,</span><span class="n">y</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">y</span><span class="p">.</span><span class="n">CarType</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w"> </span><span class="n">x</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">y</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">z</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="n">w</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">z</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="n">w</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">y</span><span class="p">.</span><span class="n">CarType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">---è¿‡æ£€è½¦è¾†è”åˆæŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">BodyNo</span><span class="p">)</span><span class="err">å½“æ—¥è¿‡æ£€è½¦è¾†æ€»æ•°</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">CarType</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w"> </span><span class="n">d</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="k">g</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="k">g</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w">  </span><span class="n">d</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">CarType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--åˆå¹¶1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">DefectId</span><span class="p">)</span><span class="err">å½“æ—¥ç¼ºé™·æ•°é‡</span><span class="p">,</span><span class="n">y</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">y</span><span class="p">.</span><span class="n">CarType</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">BodyNo</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w"> </span><span class="n">d</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="k">g</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="k">g</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w">  </span><span class="n">d</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="k">g</span><span class="p">.</span><span class="n">PlineNm</span><span class="o">=</span><span class="n">w</span><span class="p">.</span><span class="n">PlineNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">DefectNm</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">DefectNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">CreTm</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">CreTm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">CarType</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">CarType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">CarType</span><span class="p">)</span><span class="err">å½“æ—¥è¿‡æ£€è½¦è¾†æ€»æ•°</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w"> </span><span class="n">x</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">y</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">z</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="n">w</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">z</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="n">w</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">y</span><span class="p">.</span><span class="n">CarType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">---åˆå¹¶2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">DefectId</span><span class="p">)</span><span class="err">å½“æ—¥ç¼ºé™·æ•°é‡</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CarType</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">BodyNo</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w"> </span><span class="n">d</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="k">g</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="k">g</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w">  </span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="k">g</span><span class="p">.</span><span class="n">PlineNm</span><span class="o">=</span><span class="k">c</span><span class="p">.</span><span class="n">PlineNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">DefectNm</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">DefectNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">CreTm</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">CarType</span><span class="p">)</span><span class="err">å½“æ—¥è¿‡æ£€è½¦è¾†æ€»æ•°</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="k">c</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="k">c</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CarType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">---ä¸€äº›æ•°æ®ç­›é€‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">CreTm</span><span class="o">=</span><span class="s1">&#39;2021-12-31 15:08:58.630&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">WcId</span><span class="o">=</span><span class="s1">&#39;8e7d9e9d-4e4d-4150-a5d7-24001e87d624&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">CreTm</span><span class="o">=</span><span class="s1">&#39;2021-12-31 15:08:58.630&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">WcId</span><span class="o">=</span><span class="s1">&#39;8e7d9e9d-4e4d-4150-a5d7-24001e87d624&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">---ç­›é€‰12.31çš„åˆ’ä¼¤æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">CreTm</span><span class="o">=</span><span class="s1">&#39;2021-12-31 15:08:58.630&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">DefectNm</span><span class="o">=</span><span class="s1">&#39;åˆ’ä¼¤&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">WcId</span><span class="o">=</span><span class="s1">&#39;7a7a468e-e25a-4f89-b462-957aa7b2a71&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">CreTm</span><span class="o">=</span><span class="s1">&#39;2021-12-31 15:08:58.630&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">WcId</span><span class="o">=</span><span class="s1">&#39;7a7a468e-e25a-4f89-b462-957aa7b2a71&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">WcId</span><span class="o">=</span><span class="s1">&#39;7a7a468e-e25a-4f89-b462-957aa7b2a71&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">PlineId</span><span class="o">=</span><span class="s1">&#39;30a5209d-d850-4156-841b-684465b518658&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w">  </span><span class="n">PlineId</span><span class="o">=</span><span class="s1">&#39;30a5209d-d850-4156-841b-684465b518658&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--ç­›é€‰2021-1-05ã€2021-11-28å‡¹é™·æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">CreTm</span><span class="o">=</span><span class="s1">&#39;2021-01-05 09:09:11.087&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">DefectNm</span><span class="o">=</span><span class="s1">&#39;å‡¹&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">WcId</span><span class="o">=</span><span class="s1">&#39;d66bfaec-4328-4802-aa6e-c1b49cf676ca&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarQualityInspection_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">CreTm</span><span class="o">=</span><span class="s1">&#39;2021-01-05 09:09:11.087&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">WcId</span><span class="o">=</span><span class="s1">&#39;d66bfaec-4328-4802-aa6e-c1b49cf676ca&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">WcId</span><span class="o">=</span><span class="s1">&#39;d66bfaec-4328-4802-aa6e-c1b49cf676ca&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">PlineId</span><span class="o">=</span><span class="s1">&#39;59a51f72-55b0-4a02-b713-4e9281f9f6919&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w">  </span><span class="n">PlineId</span><span class="o">=</span><span class="s1">&#39;59a51f72-55b0-4a02-b713-4e9281f9f6919&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">---å¦‚æœEnabledæ— æ•ˆåˆ™æ•°æ®ä¸º0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">else</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">Enabled</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Enabled</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">Enabled</span><span class="p">)</span><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span></code></pre></div><h2 id="è´¨é‡é—®é¢˜åˆ†ç±»">è´¨é‡é—®é¢˜åˆ†ç±»</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">CarType</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">DefectIssuesTypeNm</span><span class="p">,</span><span class="n">Dsc</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="n">Dsc</span><span class="p">)</span><span class="err">ç¼ºé™·æ•°</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">BBdbR_DefectIssuesType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DefectIssuesTypeNm</span><span class="p">,</span><span class="n">Dsc</span><span class="w">
</span></span></span></code></pre></div><h2 id="å•ç‚¹é—®é¢˜è¶‹åŠ¿-1">å•ç‚¹é—®é¢˜è¶‹åŠ¿</h2>
<h3 id="æ ·å¼è¡¨">æ ·å¼è¡¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">CarType</span><span class="p">)</span><span class="err">å½“æ—¥è¿‡ç‚¹è½¦æ•°é‡</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CarType</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">DefectId</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="k">c</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="k">c</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="w"> </span><span class="o">&gt;=</span><span class="s1">&#39;${startTm} 00:00:00.000&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="w"> </span><span class="o">&lt;=</span><span class="s1">&#39;${endTm} 00:00:00.000&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxMatter}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">DefectNm</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxMatter}%&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxCarType}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxCarType}%&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">PlineNm</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">PlineNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">DefectNm</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">DefectNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CarType</span><span class="p">)</span><span class="err">å½“æ—¥é—®é¢˜æ€»æ•°</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w"> </span><span class="n">d</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_WcBase</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">WcId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">WcId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">PlineId</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">PlineId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="w"> </span><span class="o">&gt;=</span><span class="s1">&#39;${startTm} 00:00:00.000&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="w"> </span><span class="o">&lt;=</span><span class="s1">&#39;${endTm} 00:00:00.000&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxMatter}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">DefectNm</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxMatter}%&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${comboBoxCarType}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">CarType</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${comboBoxCarType}%&#39;</span><span class="p">)</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">CreTm</span><span class="p">,</span><span class="n">PlineNm</span><span class="p">,</span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CarType</span><span class="w">
</span></span></span></code></pre></div><h2 id="9æŒ‰æ—¶æ®µè´¨é‡é—®é¢˜å¯¹æ¯”åˆ†ææŸ¥é‡">9.æŒ‰æ—¶æ®µè´¨é‡é—®é¢˜å¯¹æ¯”åˆ†æã€æŸ¥é‡</h2>
<h3 id="è¦æ±‚">è¦æ±‚</h3>
<p>æ ¹æ®æ—¶é—´æ®µæœç´¢è´¨é‡é—®é¢˜çš„å¯¹æ¯”ä»¥åŠåˆ†æï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®ç›¸ä¼¼çš„é—®é¢˜æ‰¾åˆ°è¯¥é—®é¢˜ä»¥å‰å‡ºç°çš„æ—¶é—´æ®µã€‚</p>
<h3 id="é€»è¾‘">é€»è¾‘</h3>
<p>é¥¼çŠ¶å›¾ ï¼›</p>
<p>æŒ‰ç…§æ—¶é—´æŒ‰æŸ¥è¯¢ï¼›</p>
<p>å±•ç¤ºç¼ºé™·å æ¯”ï¼ˆæŸç¼ºé™·æ•°é‡/æ€»ç¼ºé™·æ•°é‡ï¼‰ï¼›</p>
<p>ç‚¹å‡»é¥¼çŠ¶å›¾é—®é¢˜åŒºåŸŸï¼Œé“¾æ¥è·³è½¬åˆ°è¯¥é—®é¢˜æ˜ç»†è¡¨-å±•ç¤ºå‡ºç°è¯¥é—®é¢˜çš„æ‰€æœ‰æ—¶é—´æ®µã€è½¦å‹ç­‰ä¿¡æ¯</p>
<h3 id="sqlè¯­å¥-1">SQLè¯­å¥</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">DefectNm</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="n">DefectNm</span><span class="p">)</span><span class="err">ç¼ºé™·æ•°é‡</span><span class="p">,</span><span class="n">CreTm</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CreTm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--æ•°æ®é›†è¯­å¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">æ¯”ä¾‹ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">DefectNm</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="n">DefectNm</span><span class="p">)</span><span class="err">ç¼ºé™·æ•°é‡</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">CreTm</span><span class="w"> </span><span class="o">&gt;=</span><span class="s1">&#39;${startTm} 00:00:00.000&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">CreTm</span><span class="w"> </span><span class="o">&lt;=</span><span class="s1">&#39;${endTm} 00:00:00.000&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DefectNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">æ—¶é—´æ®µï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CreTm</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">CreTm</span><span class="w"> </span><span class="o">&gt;=</span><span class="s1">&#39;${startTm} 00:00:00.000&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">CreTm</span><span class="w"> </span><span class="o">&lt;=</span><span class="s1">&#39;${endTm} 00:00:00.000&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DefectNm</span><span class="p">,</span><span class="n">CreTm</span><span class="w">
</span></span></span></code></pre></div><h2 id="sqlç¬”è®°">SQLç¬”è®°</h2>
<h3 id="å¦‚æœenabledæ— æ•ˆåˆ™æ•°æ®ä¸º0">å¦‚æœEnabledæ— æ•ˆåˆ™æ•°æ®ä¸º0</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">---å¦‚æœEnabledæ— æ•ˆåˆ™æ•°æ®ä¸º0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="k">case</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">else</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">Enabled</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">end</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">Q_CarPartQualityInspectionDefect_Pro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Enabled</span><span class="w">
</span></span></span></code></pre></div><h2 id="6è½¦èº«æ‰€æœ‰è¿‡ç¨‹è´¨é‡é—®é¢˜æŸ¥è¯¢-è´¨é‡æ˜ç»†æ— ä»£ç é—®é¢˜å½•å…¥ç»Ÿè®¡">6.è½¦èº«æ‰€æœ‰è¿‡ç¨‹è´¨é‡é—®é¢˜æŸ¥è¯¢, è´¨é‡æ˜ç»†ã€æ— ä»£ç é—®é¢˜å½•å…¥ç»Ÿè®¡</h2>
<h3 id="å»ºè¡¨æ€è·¯">å»ºè¡¨æ€è·¯</h3>
<p>å›¾è¡¨ä¸ºç”˜ç‰¹å›¾</p>
<h1 id="è®¾å¤‡æŠ¥è¡¨">è®¾å¤‡æŠ¥è¡¨</h1>
<h2 id="1aviè½¦èº«è¿‡ç‚¹ä¿¡æ¯è¿½æº¯åŠæŸ¥è¯¢">1.AVIè½¦èº«è¿‡ç‚¹ä¿¡æ¯è¿½æº¯åŠæŸ¥è¯¢</h2>
<h3 id="sqlæŸ¥è¯¢è¯­å¥">SQLæŸ¥è¯¢è¯­å¥</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">PastTime</span><span class="p">,</span><span class="n">AviNm</span><span class="p">,</span><span class="n">PastNo</span><span class="p">,</span><span class="n">OrderCd</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">BodyNo</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">CarType</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">VIN</span><span class="p">,</span><span class="n">AviCd</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">P_CarPastInfo_Pro</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">P_ProducePlan_Pro</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">ProducePlanCd</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">ProducePlanCd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">AviCd</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%AVI%&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">PastTime</span><span class="w"> </span><span class="o">&gt;=</span><span class="s1">&#39;${startTm}&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">PastTime</span><span class="w"> </span><span class="o">&lt;=</span><span class="s1">&#39;${endTm}&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${bodyno}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">BodyNo</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${bodyno}%&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;${avicd}&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">AviNm</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%${avicd}%&#39;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">Enabled</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="err">${</span><span class="n">sort</span><span class="err">}</span><span class="w"> </span><span class="err">${</span><span class="n">sortstyle</span><span class="err">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="2è®¾å¤‡æŠ¥è­¦ä¿¡æ¯æ–‡æœ¬æ˜¾ç¤ºåŠä¼˜å…ˆçº§åˆ†ç±»">2.è®¾å¤‡æŠ¥è­¦ä¿¡æ¯æ–‡æœ¬æ˜¾ç¤ºåŠä¼˜å…ˆçº§åˆ†ç±»</h2>
<h3 id="sqlæŸ¥è¯¢è¯­å¥-1">SQLæŸ¥è¯¢è¯­å¥</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--æ–°å»ºå¤šè¯­å¥è¡¨å€¼å‡½æ•°ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1">--æœˆ
</span></span></span><span class="line"><span class="cl"><span class="c1">--[dbo].[DvcTypeDay]ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">USE</span><span class="w"> </span><span class="p">[</span><span class="n">JAC_PaintingFAS</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/****** Object:  UserDefinedFunction [dbo].[DvcTypeDay]    Script Date: 2022/4/18 11:01:36 ******/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">DvcTypeDay</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">StartTm</span><span class="w"> </span><span class="n">datetime</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">EndTm</span><span class="w"> </span><span class="n">datetime</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">PlineNm</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURNS</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="k">Table</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	 </span><span class="n">indexrow</span><span class="w"> </span><span class="n">datetime</span><span class="p">,</span><span class="n">DvcNm</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">SumTm</span><span class="w"> </span><span class="nb">float</span><span class="p">,</span><span class="n">StopNum</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">FaultStartTime</span><span class="w"> </span><span class="n">datetime</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">DurationTime</span><span class="w"> </span><span class="nb">float</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">DvcNm</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">PlineNm</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="w"> </span><span class="n">FaultStartTime</span><span class="p">,</span><span class="n">DurationTime</span><span class="p">,</span><span class="n">DvcNm</span><span class="p">,</span><span class="n">PlineNm</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="n">E_EquipmentFailureInfo_Pro</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">WorkSectionId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">WorkSectionId</span><span class="w">		
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">where</span><span class="w"> </span><span class="n">FaultStartTime</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="o">@</span><span class="n">StartTm</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="o">@</span><span class="n">EndTm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="o">=@</span><span class="n">PlineNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="k">Data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="w"> 	</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">FaultStartTime</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span><span class="n">DvcNm</span><span class="p">,</span><span class="k">Sum</span><span class="p">(</span><span class="n">DurationTime</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="n">SumTm</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">StopNum</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DvcNm</span><span class="p">,</span><span class="k">convert</span><span class="p">(</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">FaultStartTime</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w">		 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">RETURN</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">--æ–°å»ºå¤šè¯­å¥è¡¨å€¼å‡½æ•°ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1">--å‘¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">USE</span><span class="w"> </span><span class="p">[</span><span class="n">JAC_PaintingFAS</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/****** Object:  UserDefinedFunction [dbo].[DvcTypeWeek]    Script Date: 2022/4/19 15:58:50 ******/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">DvcTypeWeek</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">StartTm</span><span class="w"> </span><span class="n">datetime</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">EndTm</span><span class="w"> </span><span class="n">datetime</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">PlineNm</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURNS</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">@</span><span class="k">Data</span><span class="w"> </span><span class="k">Table</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	 </span><span class="n">indexrow</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">DvcNm</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">SumTm</span><span class="w"> </span><span class="nb">float</span><span class="p">,</span><span class="n">StopNum</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">FaultStartTime</span><span class="w"> </span><span class="n">datetime</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">DurationTime</span><span class="w"> </span><span class="nb">float</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">DvcNm</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">PlineNm</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="w"> </span><span class="n">FaultStartTime</span><span class="p">,</span><span class="n">DurationTime</span><span class="p">,</span><span class="n">DvcNm</span><span class="p">,</span><span class="n">PlineNm</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="n">E_EquipmentFailureInfo_Pro</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">BBdbR_PlineBase</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">WorkSectionId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">WorkSectionId</span><span class="w">		
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">where</span><span class="w"> </span><span class="n">FaultStartTime</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="o">@</span><span class="n">StartTm</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="o">@</span><span class="n">EndTm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">and</span><span class="w"> </span><span class="n">PlineNm</span><span class="o">=@</span><span class="n">PlineNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">@</span><span class="k">Data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="w"> 	</span><span class="n">DATEPART</span><span class="p">(</span><span class="n">WEEK</span><span class="p">,</span><span class="n">FaultStartTime</span><span class="p">),</span><span class="n">DvcNm</span><span class="p">,</span><span class="k">Sum</span><span class="p">(</span><span class="n">DurationTime</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="n">SumTm</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">StopNum</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">@</span><span class="n">InnerData</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DvcNm</span><span class="p">,</span><span class="n">DATEPART</span><span class="p">(</span><span class="n">WEEK</span><span class="p">,</span><span class="n">FaultStartTime</span><span class="p">),</span><span class="n">DvcNm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">RETURN</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="w">
</span></span></span></code></pre></div><h2 id="3è®¾å¤‡è¿è¡Œè¶‹åŠ¿æ›²çº¿æŠ¥è¡¨å±•ç¤º">3.è®¾å¤‡è¿è¡Œè¶‹åŠ¿æ›²çº¿æŠ¥è¡¨å±•ç¤º</h2>
<h3 id="æ€è·¯åˆ†æ">æ€è·¯åˆ†æ</h3>
<p>æŠ˜çº¿å›¾</p>
<p>åˆ†ç±»ï¼šè®¾å¤‡åç§°</p>
<p>ç³»åˆ—ï¼šå¼‚å¸¸æ—¶é•¿åŠå¼‚å¸¸æ¬¡æ•°</p>
<h3 id="sqlè¯­å¥-2">SQLè¯­å¥</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> 	</span><span class="n">DvcNm</span><span class="p">,</span><span class="k">Sum</span><span class="p">(</span><span class="n">DurationTime</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="n">SumTm</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">StopNum</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="n">E_EquipmentFailureInfo_Pro</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DvcNm</span><span class="w">
</span></span></span></code></pre></div>
</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/p/finebinote/">
        
        

        <div class="article-details">
            <h2 class="article-title">FineBInote</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/windows%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91%E5%A4%87%E5%BF%98/">
        
        

        <div class="article-details">
            <h2 class="article-title">windowsæœåŠ¡å¼€å‘å¤‡å¿˜</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2024 think hy how to learn
    </section>
    
    <section class="powerby">
         <br />
        
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<!doctype html>
<html lang="en">
<head>
   
</head>









<body>
</body>

</html>


    </body>
</html>
